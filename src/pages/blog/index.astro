---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../consts";
import { getBlogPostUrl } from "../../utils/blog";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout title={`Blog - ${SITE_TITLE}`} description={SITE_DESCRIPTION}>
  <!-- Blog Header -->
  <section class="px-4 pt-20 pb-16 sm:px-6 lg:px-8">
    <div class="mx-auto max-w-7xl">
      <div class="text-center">
        <h1 class="mb-4 text-4xl font-bold md:text-6xl">
          <span class="text-blue-400">Blog</span>
        </h1>
        <p class="mb-8 text-xl text-gray-300 md:text-2xl">
          Thoughts on software engineering, blockchain, and technology
        </p>
      </div>
    </div>
  </section>

  <!-- Blog Posts -->
  <section class="bg-gray-800 py-16">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
        {
          posts.map((post) => (
            <article class="overflow-hidden rounded-lg bg-gray-900 shadow-lg transition-shadow hover:shadow-xl">
              {post.data.heroImage && (
                <div class="aspect-video overflow-hidden">
                  <Image
                    width={720}
                    height={360}
                    src={post.data.heroImage}
                    alt={post.data.title}
                    class="h-full w-full object-cover transition-transform duration-300 hover:scale-105"
                  />
                </div>
              )}
              <div class="p-6">
                <div class="mb-2 text-sm font-semibold text-blue-400">
                  <FormattedDate date={post.data.pubDate} />
                </div>
                <h3 class="mb-3 text-xl font-bold text-gray-100">
                  <a
                    href={getBlogPostUrl(post)}
                    class="transition-colors hover:text-blue-400"
                  >
                    {post.data.title}
                  </a>
                </h3>
                {post.data.description && (
                  <p class="mb-4 text-gray-300">{post.data.description}</p>
                )}
                <a
                  href={getBlogPostUrl(post)}
                  class="font-semibold text-blue-400 hover:underline"
                >
                  Read More â†’
                </a>
              </div>
            </article>
          ))
        }
      </div>
    </div>
  </section>
</BaseLayout>
